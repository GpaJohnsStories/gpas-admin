<!DOCTYPE html>
<html lang="en">
<head>

  <!-- ============================================================ 
       AUTHENTICATION GATE
       ------------------------------------------------------------
       This runs immediately when the page loads.
       If the GitHub token is missing, the user is redirected
       to the login page BEFORE anything renders.
       ============================================================ -->
 <script>
  /*
    AUTHENTICATION GATE WITH RETURN-TO SUPPORT

    - Runs immediately when the page loads
    - If no GitHub token is present:
        • Save the current page path
        • Redirect to the login screen
    - Login page will send the user back here after success
  */

  const token = sessionStorage.getItem("githubToken");

  if (!token) {
    sessionStorage.setItem("returnTo", window.location.pathname);
    window.location.href = "../index.html";
  }
</script>


  <meta charset="UTF-8">
  <meta name="google" content="notranslate">
  <title>GPA'S FAITH — CONTENT CREATOR</title>

</head>

<body
  style="
    margin:0;
    padding:0;
    font-family:'Lexend', sans-serif;
    font-size:18px;      /* 14pt equivalent for admin UI density */
    background-color:#fdfdf4;
  "
>

  <!-- ============================================================
       ADMIN MENU (LOADED VIA IFRAME)
       ------------------------------------------------------------
       The admin menu:
       - Handles site selection
       - Sets selectedSite / selectedRepo in sessionStorage
       - Does NOT know which page it is embedded in
       - Loads asynchronously
       ============================================================ -->
  <iframe
    id="adminMenuFrame"
    title="Admin Menu"
    style="
      width:1220px;
      height:70px;
      border:none;
      display:block;
      position:sticky;
      top:0;
      z-index:999;
      background:white;
      margin:0 auto 20px auto;
      overflow:hidden;
    ">
  </iframe>

  <!-- Always load the newest version of the admin menu -->
  <script>
    document.getElementById("adminMenuFrame").src =
      "admin-menu.html?v=" + Date.now();
  </script>

  <!-- ============================================================
       PAGE BODY PLACEHOLDER
       ------------------------------------------------------------
       This is intentionally empty.
       You will later add:
         - Table 1: Content Identity
         - Table 2: Discovery & Context
       ============================================================ -->
  <div
    style="
      width:1200px;
      margin:0 auto;
    ">
    <!-- Faith library creation tables will go here -->
  </div>

 <script>
  /*
    FAITH SITE ENFORCEMENT

    Page classification:
      • Single-site admin page
      • Writes content ONLY to the FAITH repo
      • Must never operate under another site context

    How this works:
      - Admin menu loads asynchronously in an iframe
      - Menu sets selectedSite / selectedRepo in sessionStorage
      - This script waits until those values exist
      - If the site is not FAITH:
          • Force FAITH + gpasfaith
          • Reload so the menu reflects the change
  */

  (function enforceFaithContext() {

    const REQUIRED_SITE = "FAITH";
    const REQUIRED_REPO = "gpasfaith";

    let attempts = 0;
    const MAX_ATTEMPTS = 20;

    const interval = setInterval(() => {

      const site = sessionStorage.getItem("selectedSite");
      const repo = sessionStorage.getItem("selectedRepo");

      // Wait until the admin menu has initialized
      if (!site || !repo) {
        attempts++;
        if (attempts > MAX_ATTEMPTS) clearInterval(interval);
        return;
      }

      clearInterval(interval);

      // Enforce FAITH context if needed
      if (site !== REQUIRED_SITE) {
        sessionStorage.setItem("selectedSite", REQUIRED_SITE);
        sessionStorage.setItem("selectedRepo", REQUIRED_REPO);
        window.location.reload();
      }

      // If already FAITH, do nothing

    }, 100);

  })();
</script>
  
</body>
</html>
